<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한정 상자</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4VK413KLDK"></script>
    <link rel="icon" href="../banner/wallpaper/pubg.png" type="image/png">
    <link rel="stylesheet" href="../styles.css"> <!-- 상위 CSS 파일을 불러옴 -->
</head>

<body>
    <!-- 페이지 헤더 -->
    <header>
        <nav>
            <ul>
                <li><a href="../../">홈</a></li>
                <li><a href="../others/calculator.html">확률 계산기</a></li>
            </ul>
        </nav>
    </header> <br>

    <!-- 상자 판매 기간 편집 -->
    <p id="sale-period"></p>

    <h1><span class="highlight-box" id="page-title"></span></h1>

    <!-- 가격은 하단의 스크립트에서 수정함. -->
    <p><span id="price-display"></span> / 10회</p>

    <div id="countdown"></div> <br>

    <div class="resultbox-rectangle-container">
        <div class="rectangle-container">
            <div id="probability-sum">확률 합계: <br> 0%</div>
        </div>

        <div class="rectangle-container">
            <div id="cost">평균 비용: <br>0 UC</div>
        </div>

        <div class="rectangle-container">
            <div id="probability-attempts">평균 횟수: <br>0회</div>
        </div>
    </div>

    <br>

    <table class="css-special-table">
        <thead>
            <tr class="css-table-head">
                <th class="css-center"><input id="select-all-checkbox" type="checkbox" onclick="toggleAllCheckboxes()"></th>
                <th class="css-center">아이템 이름</th>
                <th class="css-center">등급</th>
                <th class="css-center">확률</th>
            </tr>
        </thead>

        <tbody>
            <!-- 데이터를 표에 추가 -->
        </tbody>
    </table>

    <!-- ** 자바스크립트 명령어를 불러오는 부분 -->
    <script>
        var pagesData = [
            {
                title: "2023 할로윈 상자",
                price: 810,
                dataUrl: 'data-limited1.json',
                salePeriod: "10월 16일 ~ 11월 20일",
                targetDate: "2023-11-20T10:59:59"
            },
            {
                title: "다른 페이지 상자",
                price: 950,
                dataUrl: 'data-limited2.json',
                salePeriod: "다른 날짜",
                targetDate: "2023-12-01T12:00:00"
            },
            // 추가 페이지 데이터...
        ];

        // 페이지 초기화
        document.addEventListener('DOMContentLoaded', function () {
            // 페이지 데이터를 설정하고 처리
            setPageData();
        });

        function setPageData() {
            // 현재 URL에서 "page" 파라미터 값을 얻어오기
            var pageIndex = getPageIndexFromUrl();
            
            // 페이지 데이터 설정
            var data = pagesData[pageIndex];
            if (data) {
                document.getElementById('page-title').textContent = data.title;
                document.getElementById('price-display').textContent = data.price;
                document.getElementById('countdown').setAttribute('data-target-date', data.targetDate);
                document.getElementById('sale-period').textContent = data.salePeriod;

                // 데이터 로드 및 처리
                fetchDataAndPopulateTable(data.dataUrl);
            } else {
                // 페이지 데이터가 없을 경우에 대한 처리
                console.error('Page data not found.');
            }
        }

        function getPageIndexFromUrl() {
            // 현재 URL에서 "page" 파라미터 값을 찾아냄
            var urlParams = new URLSearchParams(window.location.search);
            var pageIndex = urlParams.get('page');

            // "page" 파라미터 값이 없거나 잘못된 경우에 기본값으로 0을 반환
            return pageIndex && !isNaN(pageIndex) ? parseInt(pageIndex, 10) : 0;
        }
    </script>
    <script src="../js-datasetup.js"></script>
    <script src="../script.js"></script>
</body>

</html>
